@tailwind base;
@tailwind components;
@tailwind utilities;

@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
@import '../styles/instagram-overlays.css';

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    font-family: 'Inter', system-ui, sans-serif;
  }
}

/* Streaming Studio Responsive Optimizations */
@layer utilities {
  .studio-layout {
    /* Ensure consistent zoom behavior */
    min-width: 1200px;
    max-width: 100vw;
  }

  .studio-column {
    /* Prevent column collapse at high zoom levels */
    min-width: 250px;
    flex-shrink: 0;
  }

  .studio-center {
    /* Ensure center column takes available space */
    min-width: 400px;
    flex: 1;
  }

  /* Optimizations for different zoom levels */
  @media (max-width: 1400px) {
    .studio-column {
      min-width: 220px;
    }
  }

  @media (max-width: 1200px) {
    .studio-column {
      min-width: 200px;
    }
  }

  /* High DPI / High zoom adjustments */
  @media (-webkit-min-device-pixel-ratio: 1.25), (min-resolution: 120dpi) {
    .studio-layout {
      zoom: 0.9;
    }
  }

  /* ========================================
     MOBILE VIEWER OPTIMIZATIONS
     Instagram Live Style
     ======================================== */

  /* Floating Comments Fade Effect */
  .floating-comments-fade {
    -webkit-mask-image: linear-gradient(
      to bottom,
      transparent 0%,
      rgba(0, 0, 0, 0.3) 15%,
      rgba(0, 0, 0, 0.7) 30%,
      black 50%
    );
    mask-image: linear-gradient(
      to bottom,
      transparent 0%,
      rgba(0, 0, 0, 0.3) 15%,
      rgba(0, 0, 0, 0.7) 30%,
      black 50%
    );
  }

  /* iOS Safe Area Insets */
  .pt-safe {
    padding-top: env(safe-area-inset-top);
  }

  .pb-safe {
    padding-bottom: env(safe-area-inset-bottom);
  }

  .pl-safe {
    padding-left: env(safe-area-inset-left);
  }

  .pr-safe {
    padding-right: env(safe-area-inset-right);
  }

  .mt-safe {
    margin-top: env(safe-area-inset-top);
  }

  .mb-safe {
    margin-bottom: env(safe-area-inset-bottom);
  }

  .safe-area-top {
    padding-top: max(1rem, env(safe-area-inset-top));
  }

  .safe-area-bottom {
    padding-bottom: max(1rem, env(safe-area-inset-bottom));
  }

  .safe-area-left {
    padding-left: max(1rem, env(safe-area-inset-left));
  }

  .safe-area-right {
    padding-right: max(1rem, env(safe-area-inset-right));
  }

  /* Portrait Mode Optimizations */
  @media (orientation: portrait) {
    .floating-comments {
      max-height: 40vh;
      bottom: 80px;
    }

    .instagram-bar-portrait {
      height: 60px;
      padding: 0.75rem 1rem;
    }
  }

  /* Landscape Mode Optimizations */
  @media (orientation: landscape) {
    .floating-comments {
      max-height: 25vh;
      bottom: 64px;
      max-width: 60vw;
    }

    .instagram-bar-landscape {
      height: 48px;
      padding: 0.5rem 1rem;
    }

    /* True Fullscreen Video on Mobile Landscape */
    .mobile-fullscreen-video {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 0;
    }

    .mobile-fullscreen-video video,
    .mobile-fullscreen-video mux-player {
      width: 100% !important;
      height: 100% !important;
      object-fit: cover;
    }
  }

  /* Glass Morphism Effects */
  .glass-effect {
    background: rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(40px);
    -webkit-backdrop-filter: blur(40px);
  }

  .glass-effect-light {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(40px);
    -webkit-backdrop-filter: blur(40px);
  }

  /* Mobile Landscape Immersive Mode */
  @media (max-width: 1024px) and (orientation: landscape) {
    /* FORCE edge-to-edge - remove ALL margins and padding */
    html, body {
      margin: 0 !important;
      padding: 0 !important;
      width: 100vw !important;
      height: 100vh !important;
      overflow: hidden !important;
    }

    /* Hide default header on mobile landscape */
    .mobile-landscape-hide {
      display: none !important;
    }

    /* Remove container padding in landscape */
    .mobile-landscape-no-container {
      max-width: none !important;
      padding: 0 !important;
      margin: 0 !important;
    }

    /* Video fills entire viewport - TRULY fullscreen */
    .video-immersive-container {
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
      width: 100vw !important;
      height: 100vh !important;
      padding: 0 !important;
      margin: 0 !important;
      border-radius: 0 !important;
      z-index: 0 !important;
    }

    /* Force MuxPlayer to fill container edge-to-edge */
    .video-immersive-container mux-player,
    .video-immersive-container mux-player video,
    .video-immersive-container mux-player::part(media) {
      width: 100% !important;
      height: 100% !important;
      object-fit: cover !important;
      border-radius: 0 !important;
    }

    /* Scale down overlays for mobile landscape - they're too massive */
    .video-immersive-container .overlay-container,
    .video-immersive-container [class*="overlay"],
    .video-immersive-container [class*="poll"],
    .video-immersive-container [class*="cta"],
    .video-immersive-container [class*="registration"] {
      transform: scale(0.6) !important;
      transform-origin: center !important;
    }

    /* Adjust specific overlay positions after scaling */
    .video-immersive-container [class*="bottom"] {
      transform-origin: bottom center !important;
    }

    .video-immersive-container [class*="top"] {
      transform-origin: top center !important;
    }

    /* All UI overlays float above */
    .ui-overlay {
      position: fixed;
      z-index: 50;
    }

    /* Prevent body scroll on mobile landscape */
    body.mobile-landscape-lock {
      overflow: hidden !important;
      position: fixed !important;
      width: 100vw !important;
      height: 100vh !important;
      margin: 0 !important;
      padding: 0 !important;
    }
  }

  /* Smooth video scaling */
  mux-player {
    --media-object-fit: cover;
    --media-object-position: center;
  }

  /* Hide MuxPlayer controls on mobile for cleaner look */
  @media (max-width: 768px) {
    mux-player::part(bottom) {
      opacity: 0;
      pointer-events: none;
    }
  }

  /* LIVE-LOCK: Hide seek controls for live streams */
  .live-locked-player::part(seek-backward-button),
  .live-locked-player::part(seek-forward-button) {
    display: none !important;
  }

  /* Hide timeline/seekbar on mobile to prevent seeking */
  @media (max-width: 768px) {
    .live-locked-player::part(time-range),
    .live-locked-player::part(time-display),
    .live-locked-player mux-time-range {
      display: none !important;
      pointer-events: none !important;
    }
  }

  /* Prevent text selection on video for cleaner interactions */
  mux-player {
    user-select: none;
    -webkit-user-select: none;
    -webkit-touch-callout: none;
  }

  /* Live-only controls: Hide play/pause, progress bar, time display */
  .live-only-controls::part(play-button),
  .live-only-controls::part(center-play-button),
  .live-only-controls::part(time-range),
  .live-only-controls::part(time-display),
  .live-only-controls::part(duration-display),
  .live-only-controls::part(current-time-display),
  .live-only-controls::part(live-button),
  .live-only-controls::part(seek-backward-button),
  .live-only-controls::part(seek-forward-button) {
    display: none !important;
    opacity: 0 !important;
    pointer-events: none !important;
  }

  /* Hide big center play button overlay */
  .live-only-controls::part(center),
  .live-only-controls mux-player::part(center) {
    pointer-events: none !important;
  }

  /* Disable click-to-pause on video itself */
  .live-only-controls video {
    pointer-events: none !important;
  }

  /* Re-enable pointer events on visible controls only */
  .live-only-controls::part(mute-button),
  .live-only-controls::part(volume-range),
  .live-only-controls::part(fullscreen-button) {
    pointer-events: auto !important;
  }

  /* Remove purple hover overlay on all MuxPlayer controls */
  mux-player::part(play-button):hover,
  mux-player::part(mute-button):hover,
  mux-player::part(volume-range):hover,
  mux-player::part(fullscreen-button):hover,
  mux-player [role="button"]:hover {
    background-color: rgba(255, 255, 255, 0.1) !important;
    backdrop-filter: blur(8px) !important;
  }

  /* Keep mute button visible but with subtle styling */
  .live-only-controls::part(mute-button) {
    display: block !important;
    background-color: rgba(0, 0, 0, 0.3);
    backdrop-filter: blur(8px);
    border-radius: 8px;
    padding: 8px;
    transition: all 0.2s ease;
  }

  .live-only-controls::part(mute-button):hover {
    background-color: rgba(255, 255, 255, 0.15) !important;
    transform: scale(1.05);
  }

  /* Fullscreen button subtle styling */
  .live-only-controls::part(fullscreen-button) {
    background-color: rgba(0, 0, 0, 0.3);
    backdrop-filter: blur(8px);
    border-radius: 8px;
    padding: 8px;
    transition: all 0.2s ease;
  }

  .live-only-controls::part(fullscreen-button):hover {
    background-color: rgba(255, 255, 255, 0.15) !important;
    transform: scale(1.05);
  }
}